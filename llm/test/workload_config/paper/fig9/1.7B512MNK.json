{
    "vars": {
        "B": 1,
        "T": 512,
        "DH": 128,
        "NH": 16,
        "KVH": 8,
        "HS": 2048,
        "L": 16,
        "pp": 16,
        "dp": 1,
        "IS": 6144,
        "avg_output": 20,
        "layernorm1_data": 0,
        "split_matmul1_out": 0,
        "matmul1_data": 0,
        "attention1_data": 0,
        "matmul2_data": 0,
        "matmul2_out": 0,
        "merge_matmul1_in": 0,
        "residual1_out": 0,
        "matmul3_data": 0,
        "matmul4_data": 0,
        "matmul4_out": 0,
        "layernorm2_data": 0,
        "split_matmul2_out": 0,
        "residual2_out": 0,
        "C": 2048,
        "R": 2,
        "P": 2048,
        "J": 6144,
        "chunk": 1,
        "loop": 21,
        "G": 4096,
        "BTC": 1048576,
        "BTC/4": 262144,
        "mn": 2,
        "k": 2,
        "BTP/2": 524288,
        "NH/2": 8,
        "T/2": 256,
        "BTP/4": 262144,
        "P/2": 1024,
        "3C/2": 3072,
        "3PC/4": 3145728,
        "3BTC/4": 786432,
        "3BTC/2": 1572864,
        "3C": 6144,
        "C/4": 512,
        "C/2": 1024,
        "CP/4": 1048576,
        "J/2": 3072,
        "PJ/4": 3145728,
        "BTJ/4": 786432,
        "BTJ/2": 1572864,
        "JP/4": 3145728
    },
    "pipeline": 1,
    "source": [
        {
            "dest": 0,
            "size": "BTP/2"
        },
        {
            "dest": 1,
            "size": "BTP/2"
        },
        {
            "dest": 2,
            "size": "BTP/2"
        },
        {
            "dest": 3,
            "size": "BTP/2"
        }
    ],
    "chips": [
        {
            "chip_id": 0,
            "cores": [
                {
                    "id": 0,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 1001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1000,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 1001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 1001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 1001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1000,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 1001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1000,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 1001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1000,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 4
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 1,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1001,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 1000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1001,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 1000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1001,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 1000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1001,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 1000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1001,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 1000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1001,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 1000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 5
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 2,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 1003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1002,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 1003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 1003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 1003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1002,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 1003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1002,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 1003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1002,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 6
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 3,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1003,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 1002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1003,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 1002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1003,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 1002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1003,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 1002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1003,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 1002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1003,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 1002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 4,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 1005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1004,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 1005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 1005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 1005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1004,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 1005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1004,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 1005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1004,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 8
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 5,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1005,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 1004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1005,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 1004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1005,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 1004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1005,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 1004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1005,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 1004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1005,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 1004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 9
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 6,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 1007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1006,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 1007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 1007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 1007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1006,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 1007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1006,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 1007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1006,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 10
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 7,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1007,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 1006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1007,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 1006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1007,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 1006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1007,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 1006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1007,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 1006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1007,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 1006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 8,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 1009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1008,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 2010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2008,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 1009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1008,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 1009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1008,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 1009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1008,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 2010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2008,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 1009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1008,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 2010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2008,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 1009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1008,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 2010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2008,
                            "cast": [
                                {
                                    "dest": 12
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 9,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1009,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 1008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 2011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2009,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1009,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 1008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1009,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 1008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1009,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 1008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 2011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2009,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1009,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 1008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 2011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2009,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1009,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 1008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 2011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2009,
                            "cast": [
                                {
                                    "dest": 13
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 10,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 1011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1010,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2010,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 2008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 1011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1010,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 1011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1010,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 1011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1010,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2010,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 2008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 1011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1010,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2010,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 2008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 11,
                                    "tag": 1011
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1010,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2010,
                            "cast": [
                                {
                                    "dest": 8,
                                    "tag": 2008
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 14
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 11,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1011,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 1010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2011,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 2009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1011,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 1010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1011,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 1010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1011,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 1010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2011,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 2009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1011,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 1010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2011,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 2009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1011,
                            "cast": [
                                {
                                    "dest": 10,
                                    "tag": 1010
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2011,
                            "cast": [
                                {
                                    "dest": 9,
                                    "tag": 2009
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 12,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 1013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1012,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 2014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2012,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 1013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1012,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 1013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1012,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 1013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1012,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 2014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2012,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 1013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1012,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 2014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2012,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 1013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1012,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 2014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2012,
                            "cast": [
                                {
                                    "dest": 16
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 13,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1013,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 1012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 2015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2013,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1013,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 1012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1013,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 1012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1013,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 1012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 2015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2013,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1013,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 1012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 2015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2013,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1013,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 1012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 2015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2013,
                            "cast": [
                                {
                                    "dest": 17
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 14,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 1015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1014,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2014,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 2012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 1015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1014,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 1015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1014,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 1015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1014,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2014,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 2012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 1015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1014,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2014,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 2012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 15,
                                    "tag": 1015
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1014,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2014,
                            "cast": [
                                {
                                    "dest": 12,
                                    "tag": 2012
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 18
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 15,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1015,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 1014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2015,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 2013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1015,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 1014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1015,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 1014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1015,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 1014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2015,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 2013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1015,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 1014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2015,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 2013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1015,
                            "cast": [
                                {
                                    "dest": 14,
                                    "tag": 1014
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2015,
                            "cast": [
                                {
                                    "dest": 13,
                                    "tag": 2013
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 16,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 1017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1016,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 2018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2016,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 1017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1016,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 1017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1016,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 1017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1016,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 2018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2016,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 1017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1016,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 2018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2016,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 1017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1016,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 2018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2016,
                            "cast": [
                                {
                                    "dest": 20
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 17,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1017,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 1016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 2019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2017,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1017,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 1016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1017,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 1016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1017,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 1016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 2019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2017,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1017,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 1016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 2019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2017,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1017,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 1016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 2019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2017,
                            "cast": [
                                {
                                    "dest": 21
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 18,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 1019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1018,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2018,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 2016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 1019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1018,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 1019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1018,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 1019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1018,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2018,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 2016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 1019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1018,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2018,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 2016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 19,
                                    "tag": 1019
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1018,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2018,
                            "cast": [
                                {
                                    "dest": 16,
                                    "tag": 2016
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 22
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 19,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1019,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 1018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2019,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 2017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1019,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 1018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1019,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 1018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1019,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 1018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2019,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 2017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1019,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 1018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2019,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 2017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1019,
                            "cast": [
                                {
                                    "dest": 18,
                                    "tag": 1018
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2019,
                            "cast": [
                                {
                                    "dest": 17,
                                    "tag": 2017
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 20,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 1021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1020,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 2022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2020,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 1021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1020,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 1021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1020,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 1021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1020,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 2022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2020,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 1021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1020,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 2022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2020,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 1021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1020,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 2022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2020,
                            "cast": [
                                {
                                    "dest": 24
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 21,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1021,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 1020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 2023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2021,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1021,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 1020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1021,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 1020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1021,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 1020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 2023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2021,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1021,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 1020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 2023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2021,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1021,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 1020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 2023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2021,
                            "cast": [
                                {
                                    "dest": 25
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 22,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 1023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1022,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2022,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 2020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 1023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1022,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 1023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1022,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 1023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1022,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2022,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 2020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 1023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1022,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2022,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 2020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 23,
                                    "tag": 1023
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1022,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2022,
                            "cast": [
                                {
                                    "dest": 20,
                                    "tag": 2020
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 26
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 23,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1023,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 1022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2023,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 2021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1023,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 1022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1023,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 1022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1023,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 1022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2023,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 2021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1023,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 1022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2023,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 2021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1023,
                            "cast": [
                                {
                                    "dest": 22,
                                    "tag": 1022
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2023,
                            "cast": [
                                {
                                    "dest": 21,
                                    "tag": 2021
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 24,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 1025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1024,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 2026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2024,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 1025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1024,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 1025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1024,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 1025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1024,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 2026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2024,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 1025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1024,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 2026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2024,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 1025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1024,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 2026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2024,
                            "cast": [
                                {
                                    "dest": 28
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 25,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1025,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 1024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 2027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2025,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1025,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 1024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1025,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 1024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1025,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 1024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 2027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2025,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1025,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 1024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 2027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2025,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1025,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 1024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 2027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2025,
                            "cast": [
                                {
                                    "dest": 29
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 26,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 1027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1026,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2026,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 2024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 1027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1026,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 1027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1026,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 1027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1026,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2026,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 2024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 1027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1026,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2026,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 2024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 27,
                                    "tag": 1027
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1026,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2026,
                            "cast": [
                                {
                                    "dest": 24,
                                    "tag": 2024
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 30
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 27,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1027,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 1026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2027,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 2025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1027,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 1026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1027,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 1026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1027,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 1026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2027,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 2025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1027,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 1026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2027,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 2025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1027,
                            "cast": [
                                {
                                    "dest": 26,
                                    "tag": 1026
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2027,
                            "cast": [
                                {
                                    "dest": 25,
                                    "tag": 2025
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 28,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 1029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1028,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 2030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2028,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 1029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1028,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 1029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1028,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 1029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1028,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 2030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2028,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 1029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1028,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 2030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2028,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 1029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1028,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 2030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2028,
                            "cast": [
                                {
                                    "dest": 32
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 29,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1029,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 1028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 2031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2029,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1029,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 1028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1029,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 1028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1029,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 1028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 2031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2029,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1029,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 1028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 2031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2029,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1029,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 1028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 2031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2029,
                            "cast": [
                                {
                                    "dest": 33
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 30,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 1031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1030,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2030,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 2028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 1031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1030,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 1031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1030,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 1031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1030,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2030,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 2028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 1031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1030,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2030,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 2028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 31,
                                    "tag": 1031
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1030,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2030,
                            "cast": [
                                {
                                    "dest": 28,
                                    "tag": 2028
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 34
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 31,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1031,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 1030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2031,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 2029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1031,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 1030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1031,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 1030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1031,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 1030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2031,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 2029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1031,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 1030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2031,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 2029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1031,
                            "cast": [
                                {
                                    "dest": 30,
                                    "tag": 1030
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2031,
                            "cast": [
                                {
                                    "dest": 29,
                                    "tag": 2029
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 32,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 1033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1032,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 2034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2032,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 1033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1032,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 1033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1032,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 1033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1032,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 2034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2032,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 1033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1032,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 2034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2032,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 1033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1032,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 2034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2032,
                            "cast": [
                                {
                                    "dest": 36
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 33,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1033,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 1032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 2035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2033,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1033,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 1032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1033,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 1032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1033,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 1032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 2035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2033,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1033,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 1032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 2035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2033,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1033,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 1032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 2035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2033,
                            "cast": [
                                {
                                    "dest": 37
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 34,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 1035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1034,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2034,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 2032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 1035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1034,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 1035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1034,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 1035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1034,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2034,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 2032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 1035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1034,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2034,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 2032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 35,
                                    "tag": 1035
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1034,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2034,
                            "cast": [
                                {
                                    "dest": 32,
                                    "tag": 2032
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 38
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 35,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1035,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 1034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2035,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 2033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1035,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 1034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1035,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 1034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1035,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 1034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2035,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 2033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1035,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 1034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2035,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 2033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1035,
                            "cast": [
                                {
                                    "dest": 34,
                                    "tag": 1034
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2035,
                            "cast": [
                                {
                                    "dest": 33,
                                    "tag": 2033
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 36,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 1037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1036,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 2038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2036,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 1037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1036,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 1037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1036,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 1037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1036,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 2038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2036,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 1037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1036,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 2038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2036,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 1037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1036,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 2038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2036,
                            "cast": [
                                {
                                    "dest": 40
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 37,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1037,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 1036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 2039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2037,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1037,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 1036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1037,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 1036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1037,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 1036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 2039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2037,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1037,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 1036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 2039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2037,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1037,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 1036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 2039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2037,
                            "cast": [
                                {
                                    "dest": 41
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 38,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 1039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1038,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2038,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 2036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 1039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1038,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 1039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1038,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 1039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1038,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2038,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 2036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 1039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1038,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2038,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 2036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 39,
                                    "tag": 1039
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1038,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2038,
                            "cast": [
                                {
                                    "dest": 36,
                                    "tag": 2036
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 42
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 39,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1039,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 1038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2039,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 2037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1039,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 1038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1039,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 1038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1039,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 1038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2039,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 2037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1039,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 1038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2039,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 2037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1039,
                            "cast": [
                                {
                                    "dest": 38,
                                    "tag": 1038
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2039,
                            "cast": [
                                {
                                    "dest": 37,
                                    "tag": 2037
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 40,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 1041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1040,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 2042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2040,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 1041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1040,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 1041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1040,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 1041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1040,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 2042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2040,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 1041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1040,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 2042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2040,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 1041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1040,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 2042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2040,
                            "cast": [
                                {
                                    "dest": 44
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 41,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1041,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 1040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 2043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2041,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1041,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 1040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1041,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 1040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1041,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 1040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 2043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2041,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1041,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 1040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 2043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2041,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1041,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 1040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 2043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2041,
                            "cast": [
                                {
                                    "dest": 45
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 42,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 1043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1042,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2042,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 2040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 1043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1042,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 1043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1042,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 1043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1042,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2042,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 2040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 1043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1042,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2042,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 2040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 43,
                                    "tag": 1043
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1042,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2042,
                            "cast": [
                                {
                                    "dest": 40,
                                    "tag": 2040
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 46
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 43,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1043,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 1042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2043,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 2041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1043,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 1042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1043,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 1042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1043,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 1042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2043,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 2041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1043,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 1042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2043,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 2041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1043,
                            "cast": [
                                {
                                    "dest": 42,
                                    "tag": 1042
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2043,
                            "cast": [
                                {
                                    "dest": 41,
                                    "tag": 2041
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 44,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 1045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1044,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 2046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2044,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 1045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1044,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 1045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1044,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 1045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1044,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 2046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2044,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 1045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1044,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 2046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2044,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 1045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1044,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 2046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2044,
                            "cast": [
                                {
                                    "dest": 48
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 45,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1045,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 1044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 2047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2045,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1045,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 1044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1045,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 1044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1045,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 1044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 2047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2045,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1045,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 1044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 2047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2045,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1045,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 1044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 2047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2045,
                            "cast": [
                                {
                                    "dest": 49
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 46,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 1047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1046,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2046,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 2044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 1047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1046,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 1047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1046,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 1047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1046,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2046,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 2044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 1047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1046,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2046,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 2044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 47,
                                    "tag": 1047
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1046,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2046,
                            "cast": [
                                {
                                    "dest": 44,
                                    "tag": 2044
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 50
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 47,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1047,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 1046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2047,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 2045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1047,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 1046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1047,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 1046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1047,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 1046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2047,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 2045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1047,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 1046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2047,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 2045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1047,
                            "cast": [
                                {
                                    "dest": 46,
                                    "tag": 1046
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2047,
                            "cast": [
                                {
                                    "dest": 45,
                                    "tag": 2045
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 48,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 1049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1048,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 2050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2048,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 1049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1048,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 1049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1048,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 1049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1048,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 2050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2048,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 1049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1048,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 2050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2048,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 1049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1048,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 2050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2048,
                            "cast": [
                                {
                                    "dest": 52
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 49,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1049,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 1048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 2051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2049,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1049,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 1048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1049,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 1048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1049,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 1048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 2051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2049,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1049,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 1048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 2051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2049,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1049,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 1048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 2051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2049,
                            "cast": [
                                {
                                    "dest": 53
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 50,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 1051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1050,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2050,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 2048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 1051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1050,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 1051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1050,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 1051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1050,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2050,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 2048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 1051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1050,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2050,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 2048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 51,
                                    "tag": 1051
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1050,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2050,
                            "cast": [
                                {
                                    "dest": 48,
                                    "tag": 2048
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 54
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 51,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1051,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 1050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2051,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 2049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1051,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 1050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1051,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 1050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1051,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 1050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2051,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 2049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1051,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 1050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2051,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 2049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1051,
                            "cast": [
                                {
                                    "dest": 50,
                                    "tag": 1050
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2051,
                            "cast": [
                                {
                                    "dest": 49,
                                    "tag": 2049
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 52,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 1053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1052,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 2054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2052,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 1053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1052,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 1053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1052,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 1053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1052,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 2054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2052,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 1053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1052,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 2054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2052,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 1053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1052,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 2054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2052,
                            "cast": [
                                {
                                    "dest": 56
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 53,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1053,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 1052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 2055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2053,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1053,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 1052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1053,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 1052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1053,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 1052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 2055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2053,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1053,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 1052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 2055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2053,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1053,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 1052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 2055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2053,
                            "cast": [
                                {
                                    "dest": 57
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 54,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 1055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1054,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2054,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 2052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 1055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1054,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 1055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1054,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 1055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1054,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2054,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 2052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 1055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1054,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2054,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 2052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 55,
                                    "tag": 1055
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1054,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2054,
                            "cast": [
                                {
                                    "dest": 52,
                                    "tag": 2052
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 58
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 55,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1055,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 1054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2055,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 2053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1055,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 1054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1055,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 1054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1055,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 1054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2055,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 2053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1055,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 1054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2055,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 2053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1055,
                            "cast": [
                                {
                                    "dest": 54,
                                    "tag": 1054
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2055,
                            "cast": [
                                {
                                    "dest": 53,
                                    "tag": 2053
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 56,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 1057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1056,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 2058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2056,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 1057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1056,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 1057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1056,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 1057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1056,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 2058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2056,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 1057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1056,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 2058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2056,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 1057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1056,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 2058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2056,
                            "cast": [
                                {
                                    "dest": 60
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 57,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1057,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 1056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 2059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2057,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1057,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 1056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1057,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 1056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1057,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 1056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 2059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2057,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1057,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 1056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 2059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2057,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1057,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 1056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 2059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2057,
                            "cast": [
                                {
                                    "dest": 61
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 58,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 1059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1058,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2058,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 2056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 1059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1058,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 1059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1058,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 1059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1058,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2058,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 2056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 1059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1058,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2058,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 2056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 59,
                                    "tag": 1059
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1058,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2058,
                            "cast": [
                                {
                                    "dest": 56,
                                    "tag": 2056
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 62
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 59,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1059,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 1058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2059,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 2057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1059,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 1058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1059,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 1058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1059,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 1058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2059,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 2057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1059,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 1058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2059,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 2057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1059,
                            "cast": [
                                {
                                    "dest": 58,
                                    "tag": 1058
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2059,
                            "cast": [
                                {
                                    "dest": 57,
                                    "tag": 2057
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 60,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 1061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1060,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 2062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2060,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 1061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1060,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 1061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1060,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 1061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1060,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 2062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2060,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 1061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1060,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 2062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2060,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 1061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1060,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 2062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2060,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 0,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 61,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1061,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 1060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 2063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2061,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1061,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 1060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1061,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 1060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1061,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 1060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 2063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2061,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1061,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 1060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 2063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2061,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1061,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 1060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 2063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2061,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 1,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 62,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 1063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1062,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2062,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 2060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 1063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1062,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 1063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1062,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 1063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1062,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2062,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 2060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 1063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1062,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2062,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 2060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 63,
                                    "tag": 1063
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1062,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2062,
                            "cast": [
                                {
                                    "dest": 60,
                                    "tag": 2060
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 2,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 63,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm1_out",
                                        "outdata": "matmul1_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1063,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 1062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_2_w",
                                        "outdata": "eternal_matmul1_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3PC/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul1_1_w",
                                        "outdata": "DEL_eternal_matmul1_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "3C/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul1_1_out matmul1_2_out",
                                        "outdata": "matmul1_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC/2",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2063,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 2061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "_k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "3C/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1063,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 1062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/2",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1063,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 1062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTC/4",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "attention1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_attention1_out",
                                        "outdata": "matmul2_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1063,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 1062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_2_w",
                                        "outdata": "eternal_matmul2_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "CP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul2_1_w",
                                        "outdata": "DEL_eternal_matmul2_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "C/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_1_out matmul2_2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2063,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 2061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul2_out",
                                        "outdata": "matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul2_out k_matmul2_2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "layernorm1_in k_matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP/2",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "sram_address": {
                                        "indata": "_switch_layernorm2_out",
                                        "outdata": "matmul3_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1063,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 1062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_2_w",
                                        "outdata": "eternal_matmul3_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "PJ/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul3_1_w",
                                        "outdata": "DEL_eternal_matmul3_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "OC": "J/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul3_1_out matmul3_2_out",
                                        "outdata": "matmul3_out"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ/2",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2063,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 2061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "_k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "sram_address": {
                                        "indata": "_gelu1_out",
                                        "outdata": "matmul4_1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 1063,
                            "cast": [
                                {
                                    "dest": 62,
                                    "tag": 1062
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_2_w",
                                        "outdata": "eternal_matmul4_2_w"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "JP/4",
                                    "sram_address": {
                                        "indata": "eternal_matmul4_1_w",
                                        "outdata": "DEL_eternal_matmul4_1_w"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "J/2",
                                    "OC": "P/2",
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P/2",
                                    "dim": 1,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_1_out matmul4_2_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2063,
                            "cast": [
                                {
                                    "dest": 61,
                                    "tag": 2061
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/2",
                                    "sram_address": {
                                        "indata": "matmul4_out",
                                        "outdata": "matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 3,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T/2",
                                    "C": "P",
                                    "dim": 2,
                                    "slice": 2,
                                    "sram_address": {
                                        "indata": "matmul4_out k_matmul4_2_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP/2",
                                    "sram_address": {
                                        "indata": "residual1_out k_matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}