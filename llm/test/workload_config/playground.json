{
    "vars": {
        "B": 1,
        "T": 1024,
        "DH": 128,
        "NH": 16,
        "KVH": 8,
        "HS": 2048,
        "L": 2,
        "pp": 2,
        "dp": 1,
        "IS": 6144,
        "avg_output": 2,
        "layernorm1_data": 0,
        "split_matmul1_out": 0,
        "matmul1_data": 0,
        "attention1_data": 0,
        "matmul2_data": 0,
        "matmul2_out": 0,
        "merge_matmul1_in": 0,
        "residual1_out": 0,
        "matmul3_data": 0,
        "matmul4_data": 0,
        "matmul4_out": 0,
        "layernorm2_data": 0,
        "split_matmul2_out": 0,
        "residual2_out": 0,
        "C": 2048,
        "R": 2,
        "P": 2048,
        "J": 6144,
        "chunk": 1,
        "loop": 3,
        "G": 4096,
        "BTC": 2097152,
        "mn": 1,
        "k": 4,
        "BTP": 2097152,
        "NH/4": 4,
        "BTP/4": 524288,
        "P/4": 512,
        "3C": 6144,
        "3BTC": 6291456,
        "3BTC/4": 1572864,
        "3C/4": 1536,
        "C/4": 512,
        "BTJ": 6291456,
        "BTJ/4": 1572864,
        "J/4": 1536
    },
    "pipeline": 1,
    "source": [
        {
            "dest": 0,
            "size": "BTP"
        },
        {
            "dest": 1,
            "size": "BTP"
        },
        {
            "dest": 2,
            "size": "BTP"
        },
        {
            "dest": 3,
            "size": "BTP"
        }
    ],
    "chips": [
        {
            "chip_id": 0,
            "cores": [
                {
                    "id": 0,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 1,
                                    "tag": 2001
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2000,
                            "cast": [
                                {
                                    "dest": 4
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 1,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2001,
                            "cast": [
                                {
                                    "dest": 2,
                                    "tag": 2002
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 5
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 2,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 3,
                                    "tag": 2003
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2002,
                            "cast": [
                                {
                                    "dest": 6
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 3,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2003,
                            "cast": [
                                {
                                    "dest": 0,
                                    "tag": 2000
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": 7
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 4,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": 5,
                                    "tag": 2005
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2004,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 0,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 5,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2005,
                            "cast": [
                                {
                                    "dest": 6,
                                    "tag": 2006
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 1,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 6,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": 7,
                                    "tag": 2007
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2006,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 2,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 7,
                    "loop": "loop",
                    "worklist": [
                        {
                            "recv_cnt": 1,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in",
                                        "outdata": "layernorm1_in"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_layernorm1_in",
                                        "outdata": "layernorm1_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm1_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm1_out",
                                        "outdata": "switch_layernorm1_out"
                                    }
                                },
                                {
                                    "type": "matmul_forward_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "3C",
                                    "sram_address": {
                                        "indata": "switch_layernorm1_out",
                                        "outdata": "matmul1_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul1_data"
                                    },
                                    "R": "R",
                                    "chunk": "chunk",
                                    "job_type": 2
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "3BTC",
                                    "OUT": "3BTC/4",
                                    "sram_address": {
                                        "indata": "matmul1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out",
                                        "outdata": "k_matmul1_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_2_out",
                                        "outdata": "k_matmul1_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_4_out",
                                        "outdata": "k_matmul1_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_3_out",
                                        "outdata": "k_matmul1_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "3C/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul1_1_out k_matmul1_2_out k_matmul1_3_out k_matmul1_4_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "3BTC/4",
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "k_matmul1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Attention_f_pd",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "NH": "NH/4",
                                    "DH": "DH",
                                    "R": "R",
                                    "job_type": 2,
                                    "sram_address": {
                                        "indata": "k_matmul1_out",
                                        "outdata": "attention1_out"
                                    },
                                    "dram_address": {
                                        "data": "attention1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "C/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "attention1_out",
                                        "outdata": "matmul2_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul2_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out",
                                        "outdata": "k_matmul2_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_2_out",
                                        "outdata": "k_matmul2_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_4_out",
                                        "outdata": "k_matmul2_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_3_out",
                                        "outdata": "k_matmul2_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul2_1_out k_matmul2_2_out k_matmul2_3_out k_matmul2_4_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul2_out",
                                        "outdata": "k_matmul2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "layernorm1_in matmul2_out",
                                        "outdata": "residual1_out"
                                    }
                                },
                                {
                                    "type": "Layernorm_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P",
                                    "sram_address": {
                                        "indata": "_residual1_out",
                                        "outdata": "layernorm2_out"
                                    },
                                    "dram_address": {
                                        "data": "layernorm2_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "layernorm2_out",
                                        "outdata": "switch_layernorm2_out"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "OC": "J",
                                    "sram_address": {
                                        "indata": "switch_layernorm2_out",
                                        "outdata": "matmul3_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul3_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTJ",
                                    "OUT": "BTJ/4",
                                    "sram_address": {
                                        "indata": "matmul3_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out",
                                        "outdata": "k_matmul3_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_2_out",
                                        "outdata": "k_matmul3_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_4_out",
                                        "outdata": "k_matmul3_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_3_out",
                                        "outdata": "k_matmul3_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul3_1_out k_matmul3_2_out k_matmul3_3_out k_matmul3_4_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "k_matmul3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Gelu_f",
                                    "N": "BTJ/4",
                                    "sram_address": {
                                        "indata": "k_matmul3_out",
                                        "outdata": "gelu1_out"
                                    },
                                    "dram_address": {
                                        "data": "gelu1_data",
                                        "out": "TODO"
                                    }
                                },
                                {
                                    "type": "Matmul_f",
                                    "B": "B",
                                    "T": "T",
                                    "C": "J/4",
                                    "OC": "P",
                                    "sram_address": {
                                        "indata": "gelu1_out",
                                        "outdata": "matmul4_out"
                                    },
                                    "dram_address": {
                                        "data": "matmul4_data"
                                    }
                                },
                                {
                                    "type": "switch_data",
                                    "IN": "BTP",
                                    "OUT": "BTP/4",
                                    "sram_address": {
                                        "indata": "_matmul4_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out",
                                        "outdata": "k_matmul4_1_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_2_out",
                                        "outdata": "k_matmul4_2_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_4_out",
                                        "outdata": "k_matmul4_4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_3_out",
                                        "outdata": "k_matmul4_3_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [],
                            "prims": [
                                {
                                    "type": "Merge_matmul",
                                    "B": "B",
                                    "T": "T",
                                    "C": "P/4",
                                    "dim": 2,
                                    "slice": 4,
                                    "sram_address": {
                                        "indata": "k_matmul4_1_out k_matmul4_2_out k_matmul4_3_out k_matmul4_4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 1,
                            "recv_tag": 2007,
                            "cast": [
                                {
                                    "dest": 4,
                                    "tag": 2004
                                }
                            ],
                            "prims": [
                                {
                                    "type": "parse_input",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                },
                                {
                                    "type": "parse_output",
                                    "size": "BTP/4",
                                    "sram_address": {
                                        "indata": "k_matmul4_out",
                                        "outdata": "k_matmul4_out"
                                    }
                                }
                            ]
                        },
                        {
                            "recv_cnt": 0,
                            "cast": [
                                {
                                    "dest": -1,
                                    "loopout": "true"
                                },
                                {
                                    "dest": 3,
                                    "loopout": "false"
                                }
                            ],
                            "prims": [
                                {
                                    "type": "Residual_f",
                                    "N": "BTP",
                                    "sram_address": {
                                        "indata": "residual1_out matmul4_out",
                                        "outdata": "residual2_out"
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}